## QML 学习之路

工作了三年，一直用**QGui** 开发比较简单的程序，之所以开始接触**QML**是因为现在客户端已经逐渐转入**JavaScript** 那套开发模式，这绝非危言耸听，并且推出 **webassembly** 后，我认为客户端和前端会逐渐走向**UI**逻辑由**JavaScript**编写，高性能的运算和操作系统设备会给 **C/C++/Rust** 编写的 **webassembly**  模块执行，这可能客户端真正意义上的强后端分离。虽然很不想承认，自己过去三年所学的技术正在犹如日出日落般推出主流的客户端开发，可能仅仅只能维持老的项目和嵌入式方向， 但客户端和前端能做的事情变得越来越多，深度也在不加深，以前人们一直以为后端比前端更有技术含量，从现在来看，前端程序员逐渐百花齐放起来，他们实现得很多效果，我自认拍马也赶不上。 为了以后能有碗饭吃，我决定给自己挖一口井，学习**QML** 并从**QML**逐渐过度到前端学习上。好了，现在开始吧！



## 一、什么是 **QML**

可能你对 **HTML** 比较熟悉，其实 **QML** 要做的事情和HTML 有些类似 —— 描述用户界面。**QML** 用于描述用户界面元素的形状和行为。用户界面能够使用 **JavaScript** 来提供修饰，或者增加更加复杂的逻辑。其结构层次：子元素从父元素上继承坐标系统，它的 **x，y** 坐标总是对应于它的父元素坐标系统。



首先使用一个简单的 **QML** 例子：

```qml
import QtQuick 2.12
import QtQuick.Window 2.12

Window {
    width: 640
    height: 480
    visible: true
    title: qsTr("测试窗口")
    Text {
        id: helloWord
        text: qsTr("hello world")
        anchors.centerIn: parent
        font.bold: true;
        font.pointSize: 20
    }
}
```

- **import** 声明导入一个指定模块，**JavaScript**资源和组件目录，写法如下：

  ```javascript
  import <ModuleIdentifier> <Version.Number> [as <Qualifier>]
  ```

- 每个 **.qml**  文件有且只有一个根元素！整个结构为属性结构

- 任何在 **QML** 文档中的元素可以通过 属性**id** 进行访问，在同一个 .qml 文件里，**id** 是唯一的



## **二、元素属性** （Properties）

属性是可以赋予静态值或绑定到动态表达式的对象的属性。属性的值可以由其他对象读取。通常，它也可以由另一个对象修改，除非特定的 **QML** 类型明确禁止对特定属性执行此操作。

| 属性值的类型 |                           **解释**                           |
| :----------: | :----------------------------------------------------------: |
|    静态值    |                   不依赖其他属性的值的常量                   |
|  绑定表达式  | 描述属性与其他属性关系的JavaScript表达式。此表达式中的变量称为属性的依赖项。<br/>QML引擎强制执行属性及其依赖项之间的关系。当任何依赖项的值发生更改时，QML引擎会自动重新计算绑定表达式，并将新结果赋给该属性。 |



**QML** 提供基础组件例如：**Item**、**Text**等都有自己特有的 **Property**， 并且我们可以添加组件的额外属性，其写法如下：

```qml
	property type name : value
```

其中 **type** 指 **value** 的类型，**qml** 支持的值类型如下：

|    类型     |           说明           |
| :---------: | :----------------------: |
|    bool     |        true/false        |
|   double    |       双精度浮点型       |
| enumeration |        命名枚举值        |
|     int     |           整形           |
|    list     |       QML 对象列表       |
|    real     |      等同于 double       |
|   string    |          字符串          |
|     url     |        资源定位器        |
|     var     | 通用类型，根据值进行推到 |
|    date     |           日期           |
|    point    |          (x, y)          |
|    rect     |  (x, y, width, height)   |
|    size     |     (width, height)      |

